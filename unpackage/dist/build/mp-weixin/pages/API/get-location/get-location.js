"use strict";const t=require("../../../common/vendor.js");var o=require("../../../common/util.js").formatLocation;const e={data:()=>({title:"getLocation",hasLocation:!1,location:{},type:""}),methods:{togglePopup(t){this.type=t},showConfirm(){this.type="showpopup"},hideConfirm(){this.type=""},async getLocation(){2!==await this.getSetting()?this.doGetLocation():this.showConfirm()},doGetLocation(){t.index.getLocation({success:t=>{this.hasLocation=!0,this.location=o(t.longitude,t.latitude)},fail:o=>{o.errMsg.indexOf("auth deny")>=0?t.index.showToast({title:"访问位置被拒绝"}):t.index.showToast({title:o.errMsg})}})},getSetting:function(){return new Promise(((o,e)=>{t.index.getSetting({success:t=>{void 0!==t.authSetting["scope.userLocation"]?t.authSetting["scope.userLocation"]?o(1):o(2):o(0)}})}))},openSetting:function(){this.hideConfirm(),t.index.openSetting({success:t=>{t.authSetting&&t.authSetting["scope.userLocation"]&&this.doGetLocation()},fail:t=>{}})},async checkPermission(){let o=permision.isIOS?await permision.requestIOS("location"):await permision.requestAndroid("android.permission.ACCESS_FINE_LOCATION");return null===o||1===o?o=1:2===o?t.index.showModal({content:"系统定位已关闭",confirmText:"确定",showCancel:!1,success:function(t){}}):o.code?t.index.showModal({content:o.message}):t.index.showModal({content:"需要定位权限",confirmText:"设置",success:function(t){t.confirm&&permision.gotoAppSetting()}}),o},clear:function(){this.hasLocation=!1}}};if(!Array){(t.resolveComponent("page-head")+t.resolveComponent("uni-popup"))()}Math;const i=t._export_sfc(e,[["render",function(o,e,i,n,s,a){return t.e({a:t.p({title:s.title}),b:!1===s.hasLocation},(s.hasLocation,{}),{c:!0===s.hasLocation},!0===s.hasLocation?{d:t.t(s.location.longitude[0]),e:t.t(s.location.longitude[1]),f:t.t(s.location.latitude[0]),g:t.t(s.location.latitude[1])}:{},{h:t.o(((...t)=>a.getLocation&&a.getLocation(...t))),i:t.o(((...t)=>a.clear&&a.clear(...t))),j:t.o(((...t)=>a.openSetting&&a.openSetting(...t))),k:t.o((t=>a.togglePopup(""))),l:t.o((t=>a.togglePopup(""))),m:t.p({show:"showpopup"===s.type,mode:"fixed"})})}]]);wx.createPage(i);
